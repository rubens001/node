<!DOCTYPE html>
<html>
<head>
	<title>nwshell</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<style type="text/css">
.json-container {
	background-color:snow;
	font-family: monospace;
	}
.item {
	margin-left:15px;
	border-left: 1px solid #d7d7d7;
}
.json-key {
	 color: red;
	 }
.json-value {
	 color: blue;
	 }
.json-string {
	 color: olive;
	 }
</style>

	<script>
		function execs() {
			var str = document.getElementById('txtCmd').value;
			var xhr = new XMLHttpRequest();
			xhr.open('POST', '/nwshell');
			xhr.setRequestHeader('Content-Type', 'application/json');
			xhr.onreadystatechange = function () {
			    if (xhr.readyState == 4 && xhr.status == 200) {
			        var respObj = JSON.parse(xhr.responseText);
			        console.log('### response',respObj); // validacao

							var resp = xhr.responseText;
							var htmlJson = formatJson(resp);
							$('.json-container').html(htmlJson);
							$('.json-container').ready(function(){

								$('.json-container').on('mouseover', 'div', function(e) {
										$(e.target).parent().css("background-color","snow");
										$(e.target).css("background-color","#FFFFCC");

										$(e.target).mouseout(function(){
											$(e.target).css("background-color","snow");
										});
								});

							});
			    }
			}
			xhr.send(JSON.stringify({cmd:str,time:(new Date())}));
		}

function formatJson(json) {
	json = json.replace(/{/g,"<div class=\"item\">{");
	json = json.replace(/\[/g,"<div class=\"item\">[");
	json = json.replace(/}\,/g,"&#125;,</div>");
	json = json.replace(/]\,/g,"&#93;,</div>");
	json = json.replace(/}/g,"}</div>");
	json = json.replace(/\]/g,"]</div>");
	json = json.replace(/,/g,",<br>");
//	json = json.replace(/\\n/g,"<br>");

	return json;
}

	</script>
</head>
<body>
<h3>Node Web Shell</h3>
<textarea id='txtCmd' name='txtCmd' rows='20' cols='90'>
'use strict'
exports.execute=function() {
return 'test';
}
</textarea><br />
<input type='button' value=' exec ' onclick='execs()' />
<br />
<!-- prettyPrint demo -->
<span class="json-container">
</span>
</body>
</html>
